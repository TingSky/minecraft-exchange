<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>å…‘æ¢å•†åº— - æˆ‘çš„ä¸–ç•Œä»»åŠ¡ç§¯åˆ†å…‘æ¢ç³»ç»Ÿ</title>
	<link rel="stylesheet" href="/static/css/style.css">
	<script>
		// æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´å‡½æ•°
		function formatDateTime(dateTimeStr) {
			const date = new Date(dateTimeStr);
			const year = date.getFullYear();
			const month = String(date.getMonth() + 1).padStart(2, '0');
			const day = String(date.getDate()).padStart(2, '0');
			const hours = String(date.getHours()).padStart(2, '0');
			const minutes = String(date.getMinutes()).padStart(2, '0');
			const seconds = String(date.getSeconds()).padStart(2, '0');
			return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
		}
	</script>
	<script src="/static/js/main.js" defer></script>
</head>
<body>
	<div class="minecraft-container">
		<header class="minecraft-header">
			<h1 class="minecraft-title">å…‘æ¢å•†åº—</h1>
			<div class="player-info">
				<span>ç©å®¶: {{.PlayerName}}</span>
				<div class="emerald-display">
					<img src="/static/images/image.png" alt="ç»¿å®çŸ³">
					<span class="emerald-count">{{.Emeralds}}</span>
				</div>
			</div>
		</header>

		<nav class="minecraft-nav">
			<a href="/" class="nav-link">é¦–é¡µ</a>
			<a href="/tasks" class="nav-link">ä»»åŠ¡ä¸­å¿ƒ</a>
			<a href="/shop" class="nav-link active">å…‘æ¢å•†åº—</a>
			<a href="/admin" class="nav-link">æ‘æ°‘ç®¡ç†</a>
		</nav>

		<main class="minecraft-main">
			<section class="shop-section">
				<h2 class="section-title">å¯å…‘æ¢ç‰©å“</h2>
				<div class="item-grid">
					{{range .Items}}
					<div class="item-card">
						<div class="item-column">
							<div class="item-image">
								<img src="/static/images/item_{{.ID}}.svg" alt="{{.Name}}" onError="this.src='/static/images/default_item.svg'">
							</div>
							<div class="item-action">
								<form action="/exchange" method="post">
									<input type="hidden" name="item_id" value="{{.ID}}">
									<button type="submit" class="minecraft-btn" {{if lt $.Emeralds .Cost}}disabled{{end}}>
										{{if lt $.Emeralds .Cost}}ç»¿å®çŸ³ä¸è¶³{{else}}ç«‹å³å…‘æ¢{{end}}
									</button>
								</form>
							</div>
						</div>
						<div class="item-column">
							<div class="item-info">
								<h3>{{.Name}}<button class="read-aloud-btn" data-text="{{.Name}}" title="æœ—è¯»åç§°">ğŸ”Š</button></h3>
								<p class="item-description">{{.Description}}<button class="read-aloud-btn" data-text="{{.Description}}" title="æœ—è¯»åç§°">ğŸ”Š</button></p>
								<div class="item-cost">
									<img src="/static/images/image.png" alt="ç»¿å®çŸ³">
									<span>{{.Cost}}</span>
								</div>
								<div class="item-stock">
									åº“å­˜: {{.Stock}}
								</div>
								<div class="item-expiry">
                                    æœ‰æ•ˆæœŸè‡³: <script>document.write(formatDateTime('{{.ExpiryTime}}'))</script>
                                </div>
							</div>
						</div>
					</div>
					{{end}}
					{{if not .Items}}
					<div class="no-items">
						<p>å½“å‰å•†åº—æš‚æ— ç‰©å“</p>
					</div>
					{{end}}
				</div>
			</section>
		</main>

		<footer class="minecraft-footer">
			<p>æˆ‘çš„ä¸–ç•Œä»»åŠ¡ç§¯åˆ†å…‘æ¢ç³»ç»Ÿ &copy; {{.Year}} - ä¸ºå­¦ä¹ æä¾›æ­£å‘åé¦ˆ</p>
		</footer>
	</div>
</body>
</html>